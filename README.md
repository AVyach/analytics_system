# Analytics – CSV Metrics (pet-project)

Streamlit-приложение для аналитики CSV-датасетов.  
Можно загрузить свой CSV, выбрать столбцы и посчитать:

- базовые «колоночные» метрики  
- продуктовые метрики (DAU/MAU, Retention, ARPU, LTV и др.)  

Работает с любыми схемами колонок через сопоставление в сайдбаре.

---

## Технологии

- Python 3.10+ (проверено на 3.12, macOS)  
- Streamlit — быстрый веб-интерфейс  
- pandas, numpy — работа с данными  
- matplotlib — гистограммы и графики  
- Собственные модули:
  - `analytics/metrics.py` — регистр метрик по столбцам  
  - `analytics/product_metrics.py` — вычисление продуктовых метрик  
  - `analytics/utils.py` — чтение CSV, корреляционная матрица  
  - `analytics/metric_info.py` — краткие описания метрик  

---

## Структура проекта

```bash
~/prog/analytics/
├─ app.py
├─ requirements.txt
└─ analytics/
   ├─ __init__.py
   ├─ metric_info.py
   ├─ metrics.py
   ├─ product_metrics.py
   └─ utils.py


⸻

Установка и запуск

cd <directory>

python3 -m venv .venv
source .venv/bin/activate

python -m pip install -U pip setuptools wheel
pip install -r requirements.txt

streamlit run app.py

После запуска приложение будет доступно в браузере:
http://localhost:8501

При необходимости можно использовать другой порт.
⸻

Использование
	1.	Загрузите CSV или нажмите «Загрузить демо-датасет» в сайдбаре.
	2.	При необходимости укажите десятичный разделитель и кодировку.
	3.	Сопоставьте колонки (для продуктовых метрик):
	•	user_id (обязательно)
	•	event_time (обязательно)
	•	event_name (обязательно)
	•	revenue, session_id, device_type, channel, feature, nps_score — опционально
	4.	Выберите временной режим: оставить как есть, привести к UTC или убрать таймзону.
	5.	Во вкладке Column stats выберите столбцы и метрики.
	6.	Во вкладке Product metrics отметьте нужные метрики и параметры.

⸻

Ожидаемые колонки

Минимальный набор:
	•	user_id — идентификатор пользователя
	•	event_time — время события
	•	event_name — название события

Опционально:
	•	revenue — выручка
	•	session_id — идентификатор сессии
	•	device_type — тип устройства
	•	channel — источник трафика
	•	feature — название фичи
	•	nps_score — оценка NPS (0–10)

⸻

Метрики

Колоночные метрики
	•	mean — среднее значение
	•	median — медиана
	•	std — стандартное отклонение (разброс)
	•	min / max / sum — минимум, максимум, сумма
	•	q05, q25, q50, q75, q95 — перцентили (5%, 25%, 50%, 75%, 95%)
	•	iqr — межквартильный размах (q75 - q25)
	•	nunique — количество уникальных значений
	•	unique_share_pct — доля уникальных значений
	•	missing / missing_pct — количество и доля пропусков
	•	zeros / negatives / positives — количество нулей, отрицательных и положительных значений
	•	skew — асимметрия распределения
	•	kurtosis — эксцесс (острота распределения)
	•	частоты значений (Top-N) — наиболее часто встречающиеся значения
	•	корреляционная матрица — взаимосвязь числовых признаков
	•	гистограммы — распределение значений

Продуктовые метрики
	| Метрика                          | Пояснение                                                   |
|----------------------------------|-------------------------------------------------------------|
| DAU                              | Количество уникальных активных пользователей за день        |
| MAU                              | Количество уникальных активных пользователей за месяц       |
| Sticky factor                    | Частота использования: отношение DAU к MAU                  |
| New users                        | Количество новых пользователей                              |
| Feature usage share              | Доля пользователей, использовавших указанную фичу           |
| Avg target actions per user      | Среднее количество целевых действий на пользователя         |
| Retention (cohort)               | Удержание пользователей по когортам (возврат)               |
| NPS                              | Net Promoter Score, показатель лояльности пользователей     |
| Conversion to action             | Конверсия пользователей в целевое действие                  |
| Conversion to purchase           | Конверсия пользователей в покупку                           |
| ARPU                             | Средняя выручка на пользователя                             |
| ARPDAU                           | Средняя выручка на активного пользователя в день            |
| ARPPDAU                          | Выручка на платящего активного пользователя в день          |
| LTV (per user, mean)             | Lifetime Value — выручка за всё время жизни пользователя    |
| Средняя длительность сессии      | Среднее время активности в рамках одной сессии              |
| Среднее число сессий на пользователя | Сколько сессий в среднем приходится на одного пользователя |
| Среднее число ошибок на сессию   | Среднее количество ошибок внутри одной сессии               |

⸻

Возможности
	•	Сопоставление колонок в сайдбаре для любых CSV
	•	Поддержка временных режимов (UTC, naive)
	•	Фильтрация по датам и разрезам (device_type, channel, feature)
	•	Выгрузка рассчитанных метрик в CSV

⸻
